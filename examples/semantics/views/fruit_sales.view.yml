name: fruit_sales
description: Fruit sales transaction data with customer and product details
datasource: local
table: fruit_sales.csv
entities:
- name: sale
  type: primary
  description: Primary sales transaction entity
  key: sale_id
- name: customer
  type: foreign
  description: Customer who made the purchase
  key: customer_id
- name: fruit
  type: foreign
  description: Fruit that was sold
  key: fruit_id
dimensions:
- name: sale_id
  type: number
  description: Unique sale identifier
  expr: id
- name: fruit_id
  type: number
  description: Fruit identifier
  expr: fruit_id
- name: customer_id
  type: number
  description: Customer identifier
  expr: customer_id
- name: quantity
  type: number
  description: Quantity of fruits sold
  expr: quantity
- name: amount
  type: number
  description: Total sale amount
  expr: amount
- name: sale_date
  type: date
  description: Date of the sale
  expr: date
- name: sale_year
  type: number
  description: Year of the sale
  expr: "EXTRACT(YEAR FROM CAST(date AS DATE))"
- name: sale_month
  type: number
  description: Month of the sale
  expr: "EXTRACT(MONTH FROM CAST(date AS DATE))"
- name: sale_day
  type: number
  description: Day of the sale
  expr: "EXTRACT(DAY FROM CAST(date AS DATE))"
- name: unit_price
  type: number
  description: Price per unit (calculated)
  expr: "CASE WHEN quantity > 0 THEN amount / quantity ELSE 0 END"
measures:
- name: total_sales
  type: count
  description: Total number of sales transactions
- name: total_revenue
  type: sum
  description: Total revenue from all sales
  expr: amount
- name: total_quantity_sold
  type: sum
  description: Total quantity of fruits sold
  expr: quantity
- name: avg_sale_amount
  type: average
  description: Average sale amount
  expr: amount
- name: avg_quantity_per_sale
  type: average
  description: Average quantity per sale
  expr: quantity
- name: avg_unit_price
  type: average
  description: Average unit price across all sales
  expr: "CASE WHEN quantity > 0 THEN amount / quantity ELSE 0 END"
- name: min_sale_amount
  type: min
  description: Minimum sale amount
  expr: amount
- name: max_sale_amount
  type: max
  description: Maximum sale amount
  expr: amount
- name: distinct_customers
  type: count_distinct
  description: Number of distinct customers
  expr: customer_id
- name: distinct_fruits
  type: count_distinct
  description: Number of distinct fruits sold
  expr: fruit_id
