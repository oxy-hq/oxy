---
title: "Google Cloud Platform (GCP) Deployment"
description: "Step-by-step guide for deploying Oxy on Google Cloud Platform"
sidebarTitle: "GCP Compute Engine"
---

# Deploy Oxy on GCP

This guide walks you through deploying Oxy on Google Cloud Platform using Compute Engine VM instances. We'll cover everything from setting up a virtual machine to configuring Oxy with proper data persistence and HTTPS access.

<Note>
  This is part of our [Hands-on Deployment Guides](/deployment/hands-on). For additional deployment options, see our [Docker Deployment Guide](/deployment/docker) or the [general deployment overview](/deployment/index).
</Note>

## Prerequisites

Before you begin, make sure you have:
- A Google Cloud Platform account
- A domain name (optional, but recommended for production deployments)
- Basic familiarity with Linux command line

## Getting a VM Instance

Follow these steps to create a VM instance in Google Cloud Platform:

<Steps>
  <Step title="Access Google Cloud Console">
    Go to the [Google Cloud Console](https://console.cloud.google.com/) and sign in with your account.
  </Step>

  <Step title="Create or Select a Project">
    Select an existing project or create a new one using the project selector at the top of the page.
  </Step>

  <Step title="Navigate to Compute Engine">
    From the navigation menu, select **Compute Engine** > **VM instances**.
    
    If this is your first time using Compute Engine, you might need to enable the API.
  </Step>

  <Step title="Create a VM Instance">
    Click the **CREATE INSTANCE** button and configure your instance:
    
    - **Name**: Choose a name for your instance (e.g., `oxy-server`)
    - **Region & Zone**: Select a region close to your users
    - **Machine Configuration**: 
      - For optimal cost-performance, consider using ARM-based instances (T2A series):
        - `t2a-standard-1` (1 vCPU ARM, 4 GB memory)
    - **Boot disk**:
      - Operating System: Ubuntu
      - Version: Latest stable (e.g., Ubuntu 22.04)
      - Size: recommended starting point 10 GB
    - **Firewall**:
      - Check "Allow HTTP traffic"
      - Check "Allow HTTPS traffic"
    
    Click **Create** to provision your VM.
  </Step>

  <Step title="Note Your External IP">
    Once your VM is ready, note the External IP address displayed in the VM instances list. You'll need this to connect to your instance and to configure your domain DNS settings if using a custom domain.
  </Step>
</Steps>

## Pointing Your Domain to the VM (Optional)

If you have a domain name you want to use for your Oxy deployment:

<Steps>
  <Step title="Access DNS Settings">
    Go to your domain registrar's website (such as GoDaddy, Namecheap, or Google Domains) and navigate to the DNS settings for your domain.
  </Step>

  <Step title="Add DNS Records">
    Add the following DNS records:
    
    - **A Record**:
      - Host/Name: `@` (represents the root domain)
      - Value/Points to: Your VM's External IP address
      - TTL: 3600 (or as recommended by your registrar)
    
    - **A Record** for www subdomain:
      - Host/Name: `www`
      - Value/Points to: Your VM's External IP address
      - TTL: 3600 (or as recommended by your registrar)
  </Step>

  <Step title="Wait for DNS Propagation">
    DNS changes can take from a few minutes to several hours to propagate. You can check the status using online tools like [whatsmydns.net](https://www.whatsmydns.net/).
  </Step>
</Steps>

## Setting Up the VM

Connect to your VM instance and prepare it for Oxy deployment:

<Steps>
  <Step title="Connect to Your VM">
    You can connect directly from the Google Cloud Console by clicking the "SSH" button next to your instance, or use a terminal:
    
    ```bash
    # If using gcloud CLI
    gcloud compute ssh --project=YOUR_PROJECT_ID --zone=YOUR_ZONE oxy-server
    
    # Or using standard SSH if you've set up SSH keys
    ssh username@EXTERNAL_IP
    ```
  </Step>

  <Step title="Update System Packages">
    ```bash
    sudo apt update
    ```
  </Step>

  <Step title="Install Essential Packages">
    ```bash
    sudo apt install -y curl wget git unzip jq nano
    ```
  </Step>
</Steps>

## Installing Oxy CLI

Let's install Oxy directly on the VM:

<Steps>
  <Step title="Install Required Dependencies">
    First, install some additional dependencies:
    
    ```bash
    sudo apt update
    sudo apt install -y build-essential libssl-dev pkg-config
    ```
  </Step>

  <Step title="Install Oxy">
    Run the official Oxy installation script:
    
    ```bash
    bash <(curl --proto '=https' --tlsv1.2 -sSf https://get.oxy.tech)
    ```
    
    This script will download and install the latest stable version of Oxy.
  </Step>

  <Step title="Verify the Installation">
    Confirm that Oxy is installed correctly:
    
    ```bash
    oxy --version
    ```
    
    You should see the version information displayed.
  </Step>
</Steps>

## Setting Up Oxy Workspace

Let's use the built-in `oxy init` command to initialize a new workspace with all the necessary files and configuration:

<Steps>
  <Step title="Create and Navigate to Workspace Directory">
    ```bash
    mkdir -p ~/oxy-workspace
    cd ~/oxy-workspace
    ```
  </Step>

  <Step title="Initialize Oxy Project">
    ```bash
    oxy init
    ```
    
    This interactive command will:
    1. Create a `config.yml` file with your database and model configurations
    2. Set up sample project files
    3. Create necessary directories like `agents` and `workflows`
    
    Follow the prompts to configure:
    - Database settings (You can start with DuckDB for simplicity)
    - Model configuration (e.g., OpenAI with your API key)
    
    The initialization process will ask for your OpenAI API key and create all the necessary configuration.
  </Step>
  
  <Step title="Alternative: Set Up Git and Clone Existing Project">
    <Note>
      If you already have an existing Oxy project in a Git repository, you should set up Git and clone your repository instead of using `oxy init`.
    </Note>
    
    First, make sure Git is properly configured:
    
    ```bash
    git config --global user.name "Your Name"
    git config --global user.email "your.email@example.com"
    ```
    
    Then clone your existing repository:
    
    ```bash
    git clone https://github.com/yourusername/your-oxy-project.git ~/oxy-workspace
    cd ~/oxy-workspace
    ```
    
    This will give you your existing project configuration and agents, which is preferable to starting from scratch if you already have a working setup.
  </Step>

  <Step title="Create Data Directory">
    ```bash
    mkdir -p ~/oxy-data
    ```
    
    This directory will store all persistent data for Oxy, including the SQLite database files.
  </Step>

  <Step title="Configure Environment Variables">
    Create a standard `.env` file in the workspace directory:
    
    ```bash
    cd ~/oxy-workspace
    nano .env
    ```
    
    Add your environment variables:
    
    ```bash
    OXY_STATE_DIR=/home/$(whoami)/oxy-data
    ```
    
    Save and exit.
    
    Note: You won't need to manually set the OpenAI API key in the environment as it's already configured during the `oxy init` process.
  </Step>
</Steps>

## Installing and Configuring Caddy

Now, let's install and configure Caddy as a reverse proxy for HTTPS and authentication:

<Steps>
  <Step title="Install Caddy">
    ```bash
    sudo apt install -y debian-keyring debian-archive-keyring apt-transport-https
    curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/gpg.key' | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg
    curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt' | sudo tee /etc/apt/sources.list.d/caddy-stable.list
    sudo apt update
    sudo apt install -y caddy
    ```
  </Step>

  <Step title="Create Caddyfile">
    ```bash
    sudo nano /etc/caddy/Caddyfile
    ```
    
    If you have a domain name:
    
    ```caddy
    (reverse_proxy_app) {
        reverse_proxy localhost:3000 {
            flush_interval -1
            transport http {
                versions 1.1 2 h2c
            }
        }
    }

    yourdomain.com {
        import reverse_proxy_app
    }
    www.yourdomain.com {
        import reverse_proxy_app
    }
    ```
    
    If you don't have a domain name and want to use the IP address:
    
    ```caddy
    (reverse_proxy_app) {
        reverse_proxy localhost:3000 {
            flush_interval -1
            transport http {
                versions 1.1 2 h2c
            }
        }
    }

    http:// {
        import reverse_proxy_app
    }
    ```
    
    Replace `yourdomain.com` with your actual domain name.
    
    Save and exit.
  </Step>

  <Step title="Configure Authentication">
    To add basic authentication to your Caddyfile:
    
    ```bash
    sudo nano /etc/caddy/Caddyfile
    ```
    
    Update your domain section to include authentication:
    
    ```caddy
    yourdomain.com {
        basicauth {
            username JDJhJDEwJEVCNmdaNEg0RHpzWjdGUGdKSG1TN09xQWdQVzlzd0ZJdUpRdzNqQ0hrd1NSdXlKTEpZQXpx
        }
        import reverse_proxy_app
    }
    ```
    
    To generate the password hash:
    
    ```bash
    sudo caddy hash-password
    # Enter your desired password when prompted
    ```
    
    Copy the resulting hash into your Caddyfile, replacing the example hash above.
    
    Save and exit.
  </Step>

  <Step title="Reload Caddy">
    ```bash
    sudo systemctl reload caddy
    ```
  </Step>
</Steps>

## Creating a Systemd Service for Oxy

To ensure Oxy runs automatically on system startup and restarts if it fails:

<Steps>
  <Step title="Create a Systemd Service File">
    ```bash
    sudo nano /etc/systemd/system/oxy.service
    ```
    
    Add the following content:
    
    ```ini
    [Unit]
    Description=Oxy Server
    After=network.target
    
    [Service]
    Type=simple
    User=YOUR_USERNAME
    WorkingDirectory=/home/YOUR_USERNAME/oxy-workspace
    EnvironmentFile=/home/YOUR_USERNAME/oxy-workspace/.env
    ExecStart=/usr/local/bin/oxy serve --host 0.0.0.0 --port 3000
    Restart=always
    RestartSec=5
    
    [Install]
    WantedBy=multi-user.target
    ```
    
    Replace `YOUR_USERNAME` with your actual username.
    
    Save and exit.
  </Step>

  <Step title="Enable and Start the Service">
    ```bash
    sudo systemctl daemon-reload
    sudo systemctl enable oxy
    sudo systemctl start oxy
    ```
  </Step>

  <Step title="Verify the Service">
    ```bash
    sudo systemctl status oxy
    ```
    
    You should see that the service is active and running.
  </Step>
</Steps>

## Starting Oxy

Let's start the Oxy service and make sure everything is working properly:

<Steps>
  <Step title="Start the Oxy Service">
    ```bash
    sudo systemctl start oxy
    ```
  </Step>

  <Step title="Check the Service Status">
    ```bash
    sudo systemctl status oxy
    ```
    
    Make sure it shows as "active (running)".
  </Step>

  <Step title="View Logs (if needed)">
    If you encounter any issues, check the logs:
    
    ```bash
    sudo journalctl -u oxy -f
    ```
    
    This command will show you the live logs from the Oxy service.
  </Step>

  <Step title="Test the Connection">
    You can test if Oxy is responding properly:
    
    ```bash
    curl http://localhost:3000/health
    ```
    
    You should get a positive response indicating that Oxy is running.
  </Step>
</Steps>

## Data Persistence

It's important to understand how Oxy handles data persistence:

- Oxy uses SQLite for its internal database by default
- All data is stored in the directory specified by `OXY_STATE_DIR` environment variable (we set it to ~/oxy-data)
- This directory contains database files, semantic information, cached query results, and workflow history

<Note>
  For production deployments, consider backing up the oxy-data directory regularly. You can set up automated backups to Google Cloud Storage using gsutil or use a persistent disk for enhanced reliability.
</Note>

## Managing Your Deployment

<Steps>
  <Step title="Stopping the Services">
    If you need to stop the Oxy service temporarily:
    
    ```bash
    sudo systemctl stop oxy
    ```
    
    To stop the Caddy service:
    
    ```bash
    sudo systemctl stop caddy
    ```
  </Step>

  <Step title="Updating Oxy">
    To update Oxy to the latest version:
    
    ```bash
    # Stop the service first
    sudo systemctl stop oxy
    
    # Run the installation script again
    bash <(curl --proto '=https' --tlsv1.2 -sSf https://get.oxy.tech)
    
    # Start the service again
    sudo systemctl start oxy
    ```
  </Step>

  <Step title="Backup Data">
    ```bash
    # Create a backup of your Oxy data
    tar -czf oxy-backup-$(date +%Y%m%d).tar.gz ~/oxy-data/
    
    # Optional: Upload to Google Cloud Storage
    gsutil cp oxy-backup-*.tar.gz gs://your-bucket-name/
    ```
    
    You'll need the `gcloud` CLI installed and authenticated for the last command.
  </Step>
</Steps>

## Machine Selection Notes

When selecting a machine for Oxy deployment, consider the following recommendations:

### ARM-based Instances (T2A Series)

GCP's T2A series offers ARM-based instances similar to Amazon's T4g series. These instances typically provide:

- **Better price-performance ratio**: Often 15-20% cost savings compared to equivalent x86 instances
- **Excellent for containerized workloads**: Great for running Oxy and supporting services
- **Energy efficiency**: Lower power consumption can translate to additional cost savings

The T2A series is particularly well-suited for Oxy deployments because:

1. Oxy doesn't require specialized hardware acceleration
2. Standard web server workloads perform well on ARM architecture
3. Both Debian and Ubuntu have well-supported ARM variants

### Instance Size Guidance

- **Minimal deployments** (1-3 users): `t2a-standard-1` (2 vCPU ARM, 4 GB memory)
- **Small deployments** (3-5 users): `t2a-standard-2` (2 vCPU ARM, 8 GB memory)
- **Medium deployments** (5-15 users): `t2a-standard-4` (4 vCPU ARM, 16 GB memory)

For x86 instances:
- **Minimal deployments**: `e2-medium` (1 vCPU, 4 GB memory)
- **Small deployments**: `e2-standard-2` (2 vCPU, 8 GB memory)

<Note>
  Oxy can run effectively with as little as 4GB of memory for most use cases. Only consider larger instances if you expect heavy concurrent usage or are working with large datasets.
</Note>

## Scaling on GCP

As your usage grows, you may need to scale your deployment:

### Vertical Scaling

1. Stop your VM from the GCP Console
2. Edit the VM configuration to increase CPU and memory
3. Start the VM again
4. Reconnect and start your Oxy services:
   ```bash
   sudo systemctl start oxy
   sudo systemctl start caddy
   ```

### Storage Scaling

1. For larger data needs, consider attaching a Persistent Disk:
   ```bash
   # Create a new persistent disk in GCP Console
   # Then attach and mount it:
   sudo mkdir -p /mnt/oxy-data
   sudo mount -o discard,defaults /dev/disk/by-id/google-[DISK_NAME] /mnt/oxy-data
   sudo chown -R $(whoami):$(whoami) /mnt/oxy-data
   
   # Copy existing data
   cp -r ~/oxy-data/* /mnt/oxy-data/
   
   # Update your systemd service file
   sudo nano /etc/systemd/system/oxy.service
   # Change the EnvironmentFile path if needed
   # Update the .env file with the new path:
   # OXY_STATE_DIR=/mnt/oxy-data
   
   # Reload systemd and restart the service
   sudo systemctl daemon-reload
   sudo systemctl restart oxy
   ```

## Troubleshooting

**Issue: Cannot access Oxy through the domain or IP**
- Check that ports 80 and 443 are open in your GCP firewall rules
- Verify DNS settings if using a domain name
- Check Caddy logs: `sudo journalctl -u caddy -f`

**Issue: Caddy cannot obtain SSL certificate**
- Ensure your domain is correctly pointing to your VM's IP address
- Check if your domain registrar supports CAA records and adjust if needed

**Issue: Oxy service won't start**
- Check the logs: `sudo journalctl -u oxy -f`
- Verify environment variables in the service file
- Ensure the workspace directory exists and has correct permissions

**Issue: Data not persisting**
- Check that OXY_STATE_DIR is set correctly in your service file
- Verify file permissions on the data directory

For further help, join our community on [Discord](https://discord.gg/m677N4EcRK).

## Next Steps

Once your GCP deployment is running:

1. Configure agents and workflows in your workspace
2. Set up regular backups for your data
3. Consider implementing a CI/CD pipeline for deploying configuration updates
4. Monitor your VM's resource usage and scale as needed

For more information on using Oxy, refer to the [main documentation](/welcome).
